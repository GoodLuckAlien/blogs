 
 >  å‰è¨€ï¼šæœ€è¿‘æœ‰æœ‹å‹åœ¨åšå°ç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å¼€å‘è¿‡é£å…¥è´­ç‰©è½¦æ•ˆæœçš„åŠŸèƒ½çš„éœ€æ±‚ã€‚é’ˆå¯¹è¿™ä¸ªæƒ…å†µä¸€äº›ç½‘ä¸Šçš„demoï¼Œå¤šå°‘ä¼šæœ‰ä¸€äº›ä¸ç¬¦åˆæƒ…æ™¯çš„é—®é¢˜ï¼ˆbugï¼‰å­˜åœ¨ï¼Œé’ˆå¯¹è¿™ä¸€æƒ…å†µå°ç¼–å†³å®šå¸®æœ‹å‹å†™ä¸€ä¸ªæ–¹æ¡ˆæ¥å¸®åŠ©è§£å†³é—®é¢˜ã€‚

## æ€è€ƒå¦‚æœå®ç° ï¼Ÿ è¶…çº§ç®€å•çš„ï¼

æ— è®ºæ˜¯å°ç¨‹åºè¿˜æ˜¯h5é£å…¥è´­ç‰©è½¦æ— éå°±æ˜¯**å¹³æŠ›** ï¼Œæˆ–è€…æ˜¯**ä¸ŠæŠ›**ä¸¤ç§æƒ…å†µï¼Œå¯¹äºè¿™ä¸¤ç§æƒ…å†µï¼Œåˆä¸­å°±å¼€å§‹å­¦ä¹ æŠ›ç‰©çº¿ç†è®ºçŸ¥è¯†æ˜¯å®Œå…¨å¯ä»¥æå®šçš„ï¼Œé«˜ä¸­ä¸€å¹´çº§ç‰©ç†å­¦çš„è‡ªç”±è½ä½“è¿åŠ¨ï¼Œå¹³æŠ›è¿åŠ¨å°±æ˜¯æŠ›ç‰©çº¿ç†è®ºçš„å…·ä½“å®ç°ã€‚

**å¹³æŠ›è¿åŠ¨**
![](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b3bddc4d605643098ef84e24fbcddf2c~tplv-k3u1fbpfcp-watermark.image)

**ä¸ŠæŠ›è¿åŠ¨**

![](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e68b544c8f9b4263b3758da80eec9223~tplv-k3u1fbpfcp-watermark.image)


## æ„å»ºè™šæ‹Ÿç›´è§’åæ ‡ç³»ï¼ŒæŠ›ç‰©çº¿ç»˜åˆ¶è½¨è¿¹ç‚¹

 **æ­¤æ–¹æ¡ˆçš„æœ¬è´¨å°±æ˜¯ï¼Œæ ¹æ®è´­ç‰©è½¦èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œåˆ†åˆ«åšä¸ºæŠ›ç‰©çº¿çš„ä¸¤ç‚¹ï¼Œè¿™æ ·ä¸€ä¸ªæ„Ÿå¿µå°±æ˜¯è¦ä»¥èµ·å§‹ç‚¹ä½œä¸ºç›´è§’åæ ‡ç³»ï¼ˆ0ï¼Œ0ï¼‰æ–¹ä¾¿åç»­å…¶ä»–åæ ‡ç‚¹çš„è¿ç®—ã€‚è¿˜æœ‰ä¸€ä¸ªåº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæ˜¯é…ç½®äº†ä¸ŠæŠ›håç§»é‡ ï¼Œå°±è¦æ±‚æœ€é«˜ç‚¹ï¼ˆé¡¶ç‚¹ï¼‰åæ ‡**

 **æ­¤æ–¹æ¡ˆå‡é€‚åˆ H5 ,å°ç¨‹åº**
 ````js

/**
 * é£å…¥è´­ç‰©è½¦ï¼Œè½¨è¿¹ç‚¹ç»˜åˆ¶
 * @author  ğŸ‘½
 * @param {Array} start`åœ¨è¿™é‡Œæ’å…¥ä»£ç ç‰‡`Point èµ·ç‚¹clientX, clientYå€¼ (å¿…è¦) 
 * @param {Array} endPoint   ç»ˆç‚¹clientX, clientYå€¼ (å¿…è¦)
 * @param {number} point     ç‚¹æ•°          (å¿…è¦) 
 * @param {number} h         æŠ›ç‰©çº¿å‘ä¸Šé«˜åº¦(ä¸ŠæŠ›è¿åŠ¨)  (å¯é€‰)
 * @param {number} hclientX  å½“å­˜åœ¨hæƒ…å†µä¸‹ï¼Œè¾¾åˆ°æœ€é«˜ç‚¹æ—¶å€™çš„clientXå€¼
 * @return {Array}  [ left ,top ] å€¼ç»„æˆçš„æ•°ç»„
 */
function flycart(startPoint, endPoint, point, h = 0, hclientX) {
    /* 
    è®¾ç½®startPoint ä¸º(0,0)ç‚¹ , æ­¤æŠ›ç‰©çº¿ç»è¿‡(0,0)ç‚¹ ï¼Œå¯ä»¥æ¨åˆ°å‡ºæ¨¡å‹å…³ç³»å¼ y =  ax^2 + bx æˆ–è€… y = ax^ 2
    1 å½“å­˜åœ¨ h çš„æƒ…å†µï¼ŒæŠ›ç‰©çº¿ä¼šyè½´å‘ä¸Šåç§» h, æ­¤æ—¶çš„å…³ç³»å¼ y = ax^2 + bx
    2 å½“ä¸å­˜åœ¨h çš„æƒ…å†µ ï¼ŒæŠ›ç‰©çº¿startPointä¸ºé¡¶ç‚¹ï¼Œ æ­¤æ—¶å…³ç³»å¼ y = ax^2 
    */

    /* å‚æ•°æ ¡éªŒ */
    function Validityparameter() {
        let isOkey = true
        Array.isArray(startPoint) && startPoint.length !== 2 && (isOkey = false)
        Array.isArray(endPoint) && endPoint.length !== 2 && (isOkey = false)
            (point.constructor !== Number) && (isOkey = false)
        return isOkey
    }

    /* å‚æ•°éªŒè¯ */
    if (!Validityparameter()) {
        return []
    }

    /* Aç‚¹æ¨ªåæ ‡ */
    const xA = 0
    /* Aç‚¹çºµåæ ‡ */
    const yA = 0
    /* xè½´åç§»é‡ */
    const offsetX = startPoint[0]
    /* yè½´åç§»é‡ */
    const offsetY = startPoint[1]
    /* Bç‚¹æ¨ªåæ ‡ */
    const xB = endPoint[0] - offsetX
    /* Bçºµåæ ‡ */
    const yB = endPoint[1] - offsetY

    /* æ ¹æ®Bç‚¹åæ ‡å’Œæœ€å¤§é«˜åº¦hæ±‚ç³»æ•°a,b å‚æ•°*/
    let b = 0
    let a = 0

    /* è®¡ç®—ç³»æ•° a ,b */
    function handerComputer() {
        if (h < 10) {
            a = yB / Math.pow(xB, 2)
        } else {
            /* å› ä¸ºä¸€èˆ¬è´­ç‰©è½¦çš„æƒ…å†µéƒ½æ˜¯å‘ä¸‹ï¼Œå®é™…ä¸Šæˆ‘ä»¬è´­ç‰©è½¦çš„åæ ‡ç³»æ˜¯åå‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè¦æŠŠh è®¾ç½®æˆè´Ÿå€¼ */
            h = -h
            /* ä¸€å…ƒäºŒæ¬¡æ±‚è§£a,b ï¼Œç°åœ¨çŸ¥é“ä¸€ç‚¹  ( xB , yB ) å¦å¤–ä¸€ç‚¹ ï¼ˆ maxHxï¼Œh ï¼‰  */
            /* æœ‰æ•ˆè¾¾åˆ°æœ€é«˜ç‚¹æ—¶å€™çš„xåæ ‡ */
            const effectMaHx = hclientX && Math.abs(hclientX - offsetX) > 0 && Math.abs(hclientX - offsetX) < Math.abs(xB)
            /* å¦‚æœhclientXä¸æ»¡è¶³è¦æ±‚ï¼Œåˆ™é€‰A , B ä¸­ç‚¹ä¸º   */
            let maxHx = effectMaHx ? (hclientX - offsetX) : (xB + xA) / 2
            /* å·²çŸ¥ä¸¤ç‚¹ æ±‚ a , bå€¼  æ ¹æ®è§£æ–¹ç¨‹å¼è§£å¾— y = ax^2 + bx  */
            a = ((yB / xB) - (h / maxHx)) / (xB - maxHx)
            /* å°† a å¸¦å…¥å…¶ä¸­ä¸€ä¸ªæ±‚è§£ b */
            b = (yB - a * Math.pow(xB, 2)) / xB
        }
    }


    /* è½¨è¿¹æ•°ç»„ */
    const travelList = []
    /* x å‡ç­‰åˆ† */
    const averageX = (xB - xA) / point

    /* å¤„ç†ç›´çº¿è¿åŠ¨ */
    function handerLinearMotion(type) {
        if (type === 'X') {
            const averageY = (yB - yA) / point
            for (let i = 1; i <= point; i++) {
                travelList.push([offsetX, i * averageY + offsetY])
            }
        } else {
            for (let i = 1; i <= point; i++) {
                travelList.push([offsetX + i * averageX, offsetY])
            }
        }
        return travelList
    }

    /* å½“ xBçš„ç»å¯¹å€¼å°äº10çš„æƒ…å†µï¼Œæˆ‘ä»¬çœ‹ä½œYè½´ç›´çº¿è¿åŠŸ    */
    if (Math.abs(xB) < 10) {
        return handerLinearMotion('X')
    }
    /*å½“ yBçš„ç»å¯¹å€¼å°äº10çš„æƒ…å†µï¼Œæˆ‘ä»¬çœ‹ä½œxè½´ç›´çº¿è¿åŠŸ  */
    if (Math.abs(yB) < 10) {
        return handerLinearMotion('Y')
    }

    handerComputer()
    /* ç»˜åˆ¶è·¯å¾„ */
    for (let i = 1; i <= point; i++) {
        const currentX = averageX * i
        const currentY = Math.pow(currentX, 2) * a + b * currentX - yA
        travelList.push([currentX + offsetX, currentY + offsetY])
    }

    return travelList
}

export default flycart
 ````

## æ•ˆæœ
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](//p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/18b7b62a36004a159fdd6a0901a11801~tplv-k3u1fbpfcp-zoom-1.image)
## å°ç¨‹åºh5é£å…¥è´­ç‰©è½¦ç»„ä»¶ï¼Ÿ
 è¿™é‡Œå¯ä»¥æŠŠè¿™ä¸ªæ–¹æ¡ˆå’Œç»„ä»¶è”ç³»åˆ°ä¸€èµ·ï¼Œäºæ˜¯ä¹é£å…¥è´­ç‰©è½¦ç»„ä»¶å°±æå®šäº†ï¼Œè¿™é‡Œå¤§å®¶è¦è®°ä½çš„ç‚¹


**1æ­¤æ–¹æ¡ˆå¾—åˆ°çš„æ˜¯æŠ›ç‰©çº¿å„ç‚¹çš„left,topå€¼ï¼Œæˆ‘ä»¬åªéœ€è¦å®šæ—¶æ”¹å˜é£å…¥è´­ç‰©è½¦çš„å›¾ç‰‡çš„leftå€¼ ,topå°±å¯ä»¥**

**2å¯ä»¥é€šè¿‡è®¡æ•°å™¨åŠŸèƒ½æ¥æ”¹å˜ç¼©æ”¾æ¯”ï¼Œè¯´ç™½äº†å°±æ˜¯æ”¹å˜å›¾ç‰‡transform:scaleå€¼**

**3ä¸è¦å¿˜è®°ç»™å›¾ç‰‡åŠ ä¸Šfixedå›ºå®šå®šä½å“¦ğŸ˜„ğŸ˜„ğŸ˜„**

**ä¸»è¦demoæ–¹æ³•(ä»…ä¾›å‚è€ƒ)**

````js
 startCart(){
    /* å¼€å¯è´­ç‰©è½¦ */
    /* this.start å‚¨å­˜èµ·å§‹ç‚¹ clientY clientY  ,this.endå‚¨å­˜æœ€ç»ˆç‚¹ clientX clientY*/
    this.start = {}
    this.start['x'] = this.data.current['x']
    this.start['y'] = this.data.current['y']
    const travelList = flycart([ this.start['x'] , this.start['y'] ] ,[ this.end['x'] , this.end['y'] ],25,50 )
    this.startAnimate(travelList)
        },
 startAnimate(travelList) {
    let index = 0
    this.setData({
        cartHidden: false,
        bus_x: this.start['x'],
        bus_y: this.start['y']
    })
    if(travelList.length===0) return
    this.timer = setInterval( ()=> {
        index++
        const currentPoint = travelList.shift()
        this.setData({
            bus_x: currentPoint[0],
            bus_y: currentPoint[1],
            scale: 1 - index / 25
        })
        if (travelList.length === 0) {
            clearInterval(this.timer)
            this.triggerEvent('close')
        }
    }, 33)
}
````
è¿™é‡Œåªåšäº†**åŸç”Ÿå°ç¨‹åºé£å…¥è´­ç‰©è½¦ç»„ä»¶**ï¼Œh5å¤§è‡´å·®åˆ«ä¸å¤§ã€‚

**gitåœ°å€å¦‚ä¸‹**



[ä»£ç åœ°å€https://github.com/AlienZhaolin/flycart](https://github.com/AlienZhaolin/flycart)


è°¢è°¢å¤§å®¶é¼“åŠ±ä¸æ”¯æŒğŸŒ¹ğŸŒ¹ğŸŒ¹,å–œæ¬¢çš„å¯ä»¥ç»™ç¬”è€…ç‚¹èµå…³æ³¨ï¼Œå…¬ä¼—å·ï¼šå‰ç«¯Sharing


